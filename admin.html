<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - LandLord</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
</head>
<body>
    <!-- Header and burger button copied -->
    <div class="box">
        <button id="burger-btn" aria-label="Open navigation">
            <span class="burger-line"></span>
            <span class="burger-line"></span>
            <span class="burger-line"></span>
        </button>
        <h1>LANDLORD</h1>
        <img id="dp" src="https://tse2.mm.bing.net/th?id=OIP.yYUwl3GDU07Q5J5ttyW9fQHaHa&pid=Api&P=0&h=220"
            alt="User Icon" onclick="showLogoutConfirmation()" style="cursor: pointer;">
    </div>

    <!-- Sidebar nav so burger works -->
    <nav>
        <button id="sidebar-back-btn" aria-label="Close sidebar" style="display:none; margin:14px 0 6px 10px; background:none; border:none; color:#ffd600; font-size:1.2em; font-weight:600; cursor:pointer; padding:4px 10px; border-radius:6px;">
          <span style="font-size:1.3em;vertical-align:middle;">&#8592;</span> <span style="font-size:0.98em;vertical-align:middle;">Back</span>
        </button>
        <ul>
            <li><a href="#" onclick="navigateTo('profile'); closeSidebar();">USER MANAGEMENT</a></li>
            <li><a href="#" onclick="navigateTo('workspace'); closeSidebar();">ACTIVITY LOGS</a></li>
        </ul>
    </nav>

    <!-- Dummy map container to satisfy shared scripts that may call navigateTo('map') -->
    <main id="map" class="container" style="display:none;"></main>

    <!-- User Management -->
    <main id="profile" class="container">
        <div style="display: flex; flex-direction: column; align-items: stretch;">
            <div style="display: flex; justify-content: flex-end; align-items: center; margin-bottom: 8px;">
                <button id="add-technician-btn" class="modal-btn save add-tech-btn"><span class="add-tech-icon">+</span></button>
            </div>
            <table class="account-table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Role</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- User rows populated by JavaScript -->
                </tbody>
            </table>
        </div>
    </main>

    <!-- Activity Logs -->
    <main id="workspace" class="container section" style="display: none;">
        <table class="activity-log-table">
            <thead>
                <tr>
                    <th>Operation name</th>
                    <th>Status</th>
                    <th>Time</th>
                    <th>Time stamp</th>
                </tr>
            </thead>
            <tbody>
                <!-- Activity log rows populated by JavaScript -->
            </tbody>
        </table>
    </main>

    <!-- Enhanced Edit User Modal -->
    <div id="edit-user-modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Edit User Account</h2>
          <button id="close-edit-modal" class="close-btn" aria-label="Close modal">&times;</button>
        </div>
        
        <div class="modal-body">
          <div class="form-group">
            <label for="edit-user-firstname">First Name</label>
            <input id="edit-user-firstname" type="text" placeholder="Enter first name" />
          </div>
          
          <div class="form-group">
            <label for="edit-user-lastname">Last Name</label>
            <input id="edit-user-lastname" type="text" placeholder="Enter last name" />
          </div>
          
          <div class="form-group">
            <label for="edit-user-email">Email Address</label>
            <input id="edit-user-email" type="email" placeholder="Enter email address" />
          </div>
          
          <input type="hidden" id="edit-user-id" />
        </div>
        
        <div class="modal-footer">
          <button class="modal-btn cancel">Cancel</button>
          <button class="modal-btn save">Save Changes</button>
        </div>
      </div>
    </div>

    <!-- Enhanced Add Technician Modal -->
    <div id="add-technician-modal">
      <div class="modal-content">
        <h2 class="modal-title">Add New Technician</h2>
        <button id="close-add-technician-modal" class="modal-close-btn" aria-label="Close modal">&times;</button>
        
        <div>
          <label for="add-tech-firstname">First Name</label>
          <input id="add-tech-firstname" type="text" class="modal-input" placeholder="Enter first name" />
          
          <label for="add-tech-lastname">Last Name</label>
          <input id="add-tech-lastname" type="text" class="modal-input" placeholder="Enter last name" />
          
          <label for="add-tech-email">Email Address</label>
          <input id="add-tech-email" type="email" class="modal-input" placeholder="Enter email address" />
          
          <div style="display: flex; gap: 12px; margin-top: 20px;">
            <button class="modal-btn cancel add-tech-cancel-btn" id="cancel-add-technician">Cancel</button>
            <button class="modal-btn save add-tech-save-btn" id="save-add-technician">Add Technician</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Enhanced Logout Confirmation Modal -->
    <div id="logout-confirmation">
        <div class="logout-content">
            <div class="logout-header">
                <h3>Confirm Logout</h3>
            </div>
            <div class="logout-body">
                <p>Are you sure you want to log out of your account? You will need to sign in again to access the system.</p>
                <div class="logout-actions">
                    <button onclick="logout()">Yes, Logout</button>
                    <button onclick="hideLogoutConfirmation()">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Burger/sidebar logic -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      var burger = document.getElementById('burger-btn');
      var nav = document.querySelector('nav');
      if (burger && nav) {
        burger.addEventListener('click', function(e) {
          nav.classList.toggle('open');
          e.stopPropagation();
        });
        window.addEventListener('resize', function() {
          if (window.innerWidth > 900) nav.classList.remove('open');
        });
        document.addEventListener('click', function(e) {
          if (nav.classList.contains('open') && !nav.contains(e.target) && e.target !== burger) {
            nav.classList.remove('open');
          }
        });
      }
    });
    function closeSidebar() {
      var nav = document.querySelector('nav');
      if (nav) nav.classList.remove('open');
    }
    // Simple section switcher for this page
    function navigateTo(sectionId) {
      document.querySelectorAll('main.container').forEach(function(section){ section.style.display = 'none'; });
      var el = document.getElementById(sectionId);
      if (el) el.style.display = 'block';
    }
    // Hash navigation support
    document.addEventListener('DOMContentLoaded', function() {
      var hash = window.location.hash.replace('#', '');
      if (hash && document.getElementById(hash)) { navigateTo(hash); }
      else { navigateTo('profile'); }
    });
    </script>

    <!-- Supabase and shared logic -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="app.js" defer></script>
</body>
</html>

<!-- Enhanced Account Settings Modal -->
<div id="account-settings-modal" class="ll-modal-overlay">
  <div class="ll-modal-card">
    <div>
      <h3>Account Settings</h3>
      <button id="account-settings-close" class="close-btn" aria-label="Close modal">&times;</button>
    </div>
    
    <div>
      <div class="ll-field">
        <label class="ll-label">Username</label>
        <input class="ll-input" id="acc-username" type="text" placeholder="Enter username" />
      </div>
      
      <div class="ll-field">
        <label class="ll-label">First Name</label>
        <input class="ll-input" id="acc-firstname" type="text" placeholder="Enter first name" />
      </div>
      
      <div class="ll-field">
        <label class="ll-label">Last Name</label>
        <input class="ll-input" id="acc-lastname" type="text" placeholder="Enter last name" />
      </div>
      
      <div class="ll-field">
        <label class="ll-label">Email Address</label>
        <input class="ll-input" id="acc-email" type="email" placeholder="Enter email address" />
      </div>
      
      <div class="ll-field">
        <label class="ll-label">New Password</label>
        <input class="ll-input" id="acc-newpwd" type="password" placeholder="Enter new password" autocomplete="new-password" />
      </div>
      
      <div class="ll-field">
        <label class="ll-label">Current Password</label>
        <input class="ll-input" id="acc-currpwd" type="password" placeholder="Enter current password" autocomplete="current-password" />
      </div>
    </div>
    
    <div class="ll-actions">
      <button class="ll-btn" id="account-settings-cancel">Cancel</button>
      <button class="ll-btn-primary" id="account-settings-save">Save Changes</button>
    </div>
  </div>
</div>


